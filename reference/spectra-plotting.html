<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plotting Spectra — spectra-plotting • Spectra</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plotting Spectra — spectra-plotting" />
<meta property="og:description" content="Spectra() can be plotted with one of the following functions
plotSpectra: plots each spectrum in its separate plot by splitting
the plot area into as many panels as there are spectra.
plotSpectraOverlay: plots all spectra in x into the same plot (as
an overlay).
plotSpectraMirror: plots a pair of spectra as a mirror plot.
Parameters x and y both have to be a Spectra of length 1. Matching
peaks (considering ppm and tolerance) are highlighted. See common()
for details on peak matching. Parameters matchCol, matchLty,
matchLwd and matchPch allow to customize how matching peaks are
indicated.

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Spectra</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/Spectra.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/RforMassSpectrometry/Spectra/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plotting Spectra</h1>
    <small class="dont-index">Source: <a href='https://github.com/RforMassSpectrometry/Spectra/blob/master/R/plotting-functions.R'><code>R/plotting-functions.R</code></a></small>
    <div class="hidden name"><code>spectra-plotting.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code><a href='addProcessing.html'>Spectra()</a></code> can be plotted with one of the following functions</p><ul>
<li><p><code>plotSpectra</code>: plots each spectrum in its separate plot by splitting
the plot area into as many panels as there are spectra.</p></li>
<li><p><code>plotSpectraOverlay</code>: plots all spectra in <code>x</code> <strong>into the same</strong> plot (as
an overlay).</p></li>
<li><p><code>plotSpectraMirror</code>: plots a pair of spectra as a <em>mirror plot</em>.
Parameters <code>x</code> and <code>y</code> both have to be a <code>Spectra</code> of length 1. Matching
peaks (considering <code>ppm</code> and <code>tolerance</code>) are highlighted. See <code>common()</code>
for details on peak matching. Parameters <code>matchCol</code>, <code>matchLty</code>,
<code>matchLwd</code> and <code>matchPch</code> allow to customize how matching peaks are
indicated.</p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>plotSpectra</span>(
  <span class='kw'>x</span>,
  xlab = <span class='st'>"m/z"</span>,
  ylab = <span class='st'>"intensity"</span>,
  type = <span class='st'>"h"</span>,
  xlim = <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  ylim = <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  main = <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='st'>"RT"</span>, <span class='fu'>rtime</span>(<span class='kw'>x</span>)),
  col = <span class='st'>"#00000080"</span>,
  labels = <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(),
  labelCex = <span class='fl'>1</span>,
  labelSrt = <span class='fl'>0</span>,
  labelAdj = <span class='kw'>NULL</span>,
  labelPos = <span class='kw'>NULL</span>,
  labelOffset = <span class='fl'>0.5</span>,
  asp = <span class='fl'>1</span>,
  <span class='kw'>...</span>
)

<span class='fu'>plotSpectraOverlay</span>(
  <span class='kw'>x</span>,
  xlab = <span class='st'>"m/z"</span>,
  ylab = <span class='st'>"intensity"</span>,
  type = <span class='st'>"h"</span>,
  xlim = <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  ylim = <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  main = <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='kw'>x</span>), <span class='st'>"spectra"</span>),
  col = <span class='st'>"#00000080"</span>,
  labels = <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(),
  labelCex = <span class='fl'>1</span>,
  labelSrt = <span class='fl'>0</span>,
  labelAdj = <span class='kw'>NULL</span>,
  labelPos = <span class='kw'>NULL</span>,
  labelOffset = <span class='fl'>0.5</span>,
  axes = <span class='fl'>TRUE</span>,
  frame.plot = <span class='kw'>axes</span>,
  <span class='kw'>...</span>
)

<span class='fu'>plotSpectraMirror</span>(
  <span class='kw'>x</span>,
  <span class='kw'>y</span>,
  xlab = <span class='st'>"m/z"</span>,
  ylab = <span class='st'>"intensity"</span>,
  type = <span class='st'>"h"</span>,
  xlim = <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  ylim = <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></span>(),
  main = <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(),
  col = <span class='st'>"#00000080"</span>,
  labels = <span class='fu'><a href='https://rdrr.io/r/base/character.html'>character</a></span>(),
  labelCex = <span class='fl'>1</span>,
  labelSrt = <span class='fl'>0</span>,
  labelAdj = <span class='kw'>NULL</span>,
  labelPos = <span class='kw'>NULL</span>,
  labelOffset = <span class='fl'>0.5</span>,
  axes = <span class='fl'>TRUE</span>,
  frame.plot = <span class='kw'>axes</span>,
  ppm = <span class='fl'>20</span>,
  tolerance = <span class='fl'>0</span>,
  matchCol = <span class='st'>"#80B1D3"</span>,
  matchLwd = <span class='fl'>1</span>,
  matchLty = <span class='fl'>1</span>,
  matchPch = <span class='fl'>16</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a <code><a href='addProcessing.html'>Spectra()</a></code> object. For <code>plotSpectraMirror</code> it has to be an
object of length 2.</p></td>
    </tr>
    <tr>
      <th>xlab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the label for the x-axis (by default
<code>xlab = "m/z"</code>).</p></td>
    </tr>
    <tr>
      <th>ylab</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the label for the y-axis (by default
<code>ylab = "intensity"</code>).</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> specifying the type of plot. See <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot.default()</a></code>
for details. Defaults to <code>type = "h"</code> which draws each peak as a line.</p></td>
    </tr>
    <tr>
      <th>xlim</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the x-axis limits. The range of m/z values
are used by default.</p></td>
    </tr>
    <tr>
      <th>ylim</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(2)</a></code> defining the y-axis limits. The range of intensity
values are used by default.</p></td>
    </tr>
    <tr>
      <th>main</th>
      <td><p><code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> with the title for the plot. By default the
spectrum's retention time (in seconds) is used.</p></td>
    </tr>
    <tr>
      <th>col</th>
      <td><p>color to be used to draw the peaks. Should be either of length 1,
or equal to the number of spectra (to plot each spectrum in a different
color) or be a <code>list</code> with colors for each individual peak in each
spectrum.</p></td>
    </tr>
    <tr>
      <th>labels</th>
      <td><p>allows to specify a label for each peak. Can be a <code>character</code>
with length equal to the number of peaks, or, ideally, a <code>function</code> that
uses one of the <code>Spectra</code>'s variables (see examples below).
<code>plotSpectraMirror</code> supports only <code>labels</code> of type <em>function</em>.</p></td>
    </tr>
    <tr>
      <th>labelCex</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> giving the amount by which the text should be
magnified relative to the default. See parameter <code>cex</code> in <code><a href='https://rdrr.io/r/graphics/par.html'>par()</a></code>.</p></td>
    </tr>
    <tr>
      <th>labelSrt</th>
      <td><p><code><a href='https://rdrr.io/r/base/numeric.html'>numeric(1)</a></code> defining the rotation of the label. See
parameter <code>srt</code> in <code><a href='https://rdrr.io/r/graphics/text.html'>text()</a></code>.</p></td>
    </tr>
    <tr>
      <th>labelAdj</th>
      <td><p>see parameter <code>adj</code> in <code><a href='https://rdrr.io/r/graphics/text.html'>text()</a></code>.</p></td>
    </tr>
    <tr>
      <th>labelPos</th>
      <td><p>see parameter <code>pos</code> in <code><a href='https://rdrr.io/r/graphics/text.html'>text()</a></code>.</p></td>
    </tr>
    <tr>
      <th>labelOffset</th>
      <td><p>see parameter <code>offset</code> in <code><a href='https://rdrr.io/r/graphics/text.html'>text()</a></code>.</p></td>
    </tr>
    <tr>
      <th>asp</th>
      <td><p>for <code>plotSpectra</code>: the target ratio (columns / rows) when plotting
mutliple spectra (e.g. for 20 spectra use <code>asp = 4/5</code> for 4 columns and 5 rows
or <code>asp = 5/4</code> for 5 columns and 4 rows; see <code><a href='https://rdrr.io/r/grDevices/n2mfrow.html'>grDevices::n2mfrow()</a></code> for
details).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional parameters to be passed to the <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot.default()</a></code>
function.</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether (x and y) axes should be drawn.</p></td>
    </tr>
    <tr>
      <th>frame.plot</th>
      <td><p><code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> whether a box should be drawn around the
plotting area.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>for <code>plotSpectraMirror</code>: <code>Spectra</code> object of length 1 against which
<code>x</code> should be plotted against.</p></td>
    </tr>
    <tr>
      <th>ppm</th>
      <td><p>for <code>plotSpectraMirror</code>: m/z relative acceptable difference (in
ppm) for peaks to be considered matching (see <code>common()</code> for more
details).</p></td>
    </tr>
    <tr>
      <th>tolerance</th>
      <td><p>for <code>plotSpectraMirror</code>: absolute acceptable difference of
m/z values for peaks to be considered matching (see <code>common()</code> for more
details).</p></td>
    </tr>
    <tr>
      <th>matchCol</th>
      <td><p>for <code>plotSpectraMirror</code>: color for matching peaks.</p></td>
    </tr>
    <tr>
      <th>matchLwd</th>
      <td><p>for <code>plotSpectraMirror</code>: line width (<code>lwd</code>) to draw matching
peaks. See <code><a href='https://rdrr.io/r/graphics/par.html'>par()</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>matchLty</th>
      <td><p>for <code>plotSpectraMirror</code>: line type (<code>lty</code>) to draw matching
peaks. See <code><a href='https://rdrr.io/r/graphics/par.html'>par()</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>matchPch</th>
      <td><p>for <code>plotSpectraMirror</code>: point character (<code>pch</code>) to label
matching peaks. Defaults to <code>matchPch = 16</code>, set to <code>matchPch = NA</code> to
disable. See <code><a href='https://rdrr.io/r/graphics/par.html'>par()</a></code> for more details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>These functions create a plot.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Johannes Rainer, Sebastian Gibb, Laurent Gatto</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>ints</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4.3412</span>, <span class='fl'>12</span>, <span class='fl'>8</span>, <span class='fl'>34</span>, <span class='fl'>23.4</span>),
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>8</span>, <span class='fl'>25</span>, <span class='fl'>16</span>, <span class='fl'>32</span>))
<span class='kw'>mzs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>13.453421</span>, <span class='fl'>43.433122</span>, <span class='fl'>46.6653553</span>, <span class='fl'>129.111212</span>, <span class='fl'>322.24432</span>),
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>13.452</span>, <span class='fl'>43.5122</span>, <span class='fl'>129.112</span>, <span class='fl'>322.245</span>))

<span class='kw'>df</span> <span class='op'>&lt;-</span> <span class='fu'>DataFrame</span>(msLevel = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1L</span>, <span class='fl'>1L</span>), rtime = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>123.12</span>, <span class='fl'>124</span>))
<span class='kw'>df</span><span class='op'>$</span><span class='kw'>mz</span> <span class='op'>&lt;-</span> <span class='kw'>mzs</span>
<span class='kw'>df</span><span class='op'>$</span><span class='kw'>intensity</span> <span class='op'>&lt;-</span> <span class='kw'>ints</span>
<span class='kw'>sp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='addProcessing.html'>Spectra</a></span>(<span class='kw'>df</span>)

<span class='co'>#### --------------------------------------------- ####</span>
<span class='co'>##                   plotSpectra                     ##</span>

<span class='co'>## Plot one spectrum.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>[<span class='fl'>1</span>])
</div><div class='input'>
<span class='co'>## Plot both spectra.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>)
</div><div class='img'><img src='spectra-plotting-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Define a color for each peak in each spectrum.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, col = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span>), <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>))
</div><div class='img'><img src='spectra-plotting-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Color peaks from each spectrum in different colors.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, col = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"green"</span>, <span class='st'>"blue"</span>))
</div><div class='img'><img src='spectra-plotting-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Label each peak with its m/z.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, labels = <span class='fu'>function</span>(<span class='kw'>z</span>) <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='fu'>mz</span>(<span class='kw'>z</span>)), digits = <span class='fl'>4</span>))
</div><div class='img'><img src='spectra-plotting-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Rotate the labels.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, labels = <span class='fu'>function</span>(<span class='kw'>z</span>) <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='fu'>mz</span>(<span class='kw'>z</span>)), digits = <span class='fl'>4</span>),
    labelPos = <span class='fl'>2</span>, labelOffset = <span class='fl'>0.1</span>, labelSrt = <span class='op'>-</span><span class='fl'>30</span>)
</div><div class='img'><img src='spectra-plotting-5.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Add a custom annotation for each peak.</span>
<span class='kw'>sp</span><span class='op'>$</span><span class='kw'>label</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>""</span>, <span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>),
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"Frodo"</span>, <span class='st'>"Bilbo"</span>, <span class='st'>"Peregrin"</span>, <span class='st'>"Samwise"</span>))
<span class='co'>## Plot each peak in a different color</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, labels = <span class='fu'>function</span>(<span class='kw'>z</span>) <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='kw'>z</span><span class='op'>$</span><span class='kw'>label</span>),
    col = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>4</span>))
</div><div class='img'><img src='spectra-plotting-6.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Plot a single spectrum specifying the label.</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>[<span class='fl'>2</span>], labels = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"A"</span>, <span class='st'>"B"</span>, <span class='st'>"C"</span>, <span class='st'>"D"</span>))
</div><div class='img'><img src='spectra-plotting-7.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>#### --------------------------------------------- ####</span>
<span class='co'>##                plotSpectraOverlay                 ##</span>

<span class='co'>## Plot both spectra overlaying.</span>
<span class='fu'>plotSpectraOverlay</span>(<span class='kw'>sp</span>)
</div><div class='img'><img src='spectra-plotting-8.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Use a different color for each spectrum.</span>
<span class='fu'>plotSpectraOverlay</span>(<span class='kw'>sp</span>, col = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"#ff000080"</span>, <span class='st'>"#0000ff80"</span>))
</div><div class='img'><img src='spectra-plotting-9.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Label also the peaks with their m/z if their intensity is above 15.</span>
<span class='fu'>plotSpectraOverlay</span>(<span class='kw'>sp</span>, col = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"#ff000080"</span>, <span class='st'>"#0000ff80"</span>),
    labels = <span class='fu'>function</span>(<span class='kw'>z</span>) {
        <span class='kw'>lbls</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span>(<span class='fu'>mz</span>(<span class='kw'>z</span>)[[<span class='fl'>1L</span>]], digits = <span class='fl'>4</span>)
        <span class='kw'>lbls</span>[<span class='fu'>intensity</span>(<span class='kw'>z</span>)[[<span class='fl'>1L</span>]] <span class='op'>&lt;=</span> <span class='fl'>15</span>] <span class='op'>&lt;-</span> <span class='st'>""</span>
        <span class='kw'>lbls</span>
    })
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span>(h = <span class='fl'>15</span>, lty = <span class='fl'>2</span>)
</div><div class='img'><img src='spectra-plotting-10.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Use different asp values</span>
<span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, asp = <span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>)
</div><div class='input'><span class='fu'>plotSpectra</span>(<span class='kw'>sp</span>, asp = <span class='fl'>2</span><span class='op'>/</span><span class='fl'>1</span>)
</div><div class='img'><img src='spectra-plotting-11.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#### --------------------------------------------- ####</span>
<span class='co'>##                plotSpectraMirror                  ##</span>

<span class='co'>## Plot two spectra against each other.</span>
<span class='fu'>plotSpectraMirror</span>(<span class='kw'>sp</span>[<span class='fl'>1</span>], <span class='kw'>sp</span>[<span class='fl'>2</span>])

<span class='co'>## Label the peaks with their m/z</span>
<span class='fu'>plotSpectraMirror</span>(<span class='kw'>sp</span>[<span class='fl'>1</span>], <span class='kw'>sp</span>[<span class='fl'>2</span>],
    labels = <span class='fu'>function</span>(<span class='kw'>z</span>) <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span>(<span class='fu'>mz</span>(<span class='kw'>z</span>)[[<span class='fl'>1L</span>]], digits = <span class='fl'>3</span>),
    labelSrt = <span class='op'>-</span><span class='fl'>30</span>, labelPos = <span class='fl'>2</span>, labelOffset = <span class='fl'>0.2</span>)
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/grid.html'>grid</a></span>()
</div><div class='img'><img src='spectra-plotting-12.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## The same plot with a tolerance of 0.1 and using a different color to</span>
<span class='co'>## highlight matching peaks</span>
<span class='fu'>plotSpectraMirror</span>(<span class='kw'>sp</span>[<span class='fl'>1</span>], <span class='kw'>sp</span>[<span class='fl'>2</span>],
    labels = <span class='fu'>function</span>(<span class='kw'>z</span>) <span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span>(<span class='fu'>mz</span>(<span class='kw'>z</span>)[[<span class='fl'>1L</span>]], digits = <span class='fl'>3</span>),
    labelSrt = <span class='op'>-</span><span class='fl'>30</span>, labelPos = <span class='fl'>2</span>, labelOffset = <span class='fl'>0.2</span>, tolerance = <span class='fl'>0.1</span>,
    matchCol = <span class='st'>"#ff000080"</span>, matchLwd = <span class='fl'>2</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/grid.html'>grid</a></span>()
</div><div class='img'><img src='spectra-plotting-13.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by RforMassSpectrometry Package Maintainer, Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


